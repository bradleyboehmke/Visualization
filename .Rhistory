legend.justification=c(0, 1),
legend.position=c(.1, 1.05),
legend.background = element_blank(),
legend.direction="horizontal",
text = element_text(family = "Georgia"),
plot.title = element_text(size = 20, margin = margin(b = 10)),
plot.subtitle = element_text(size = 12, color = "darkslategrey", margin = margin(b = 25)),
plot.caption = element_text(size = 8, margin = margin(t = 10), color = "grey70", hjust = 0))
?margin
p + scale_color_discrete(labels = c("Female", "Male")) +
scale_x_continuous(labels = scales::dollar, expand = c(0.02, 0),
limits = c(0, 10000),
breaks = seq(0, 10000, by = 2000)) +
scale_y_discrete(expand = c(.02, 0)) +
labs(title = "Total Revenue by City and Gender",
subtitle = "Out of 23 cities, eight locations experience a 20% or greater difference in \nrevenue generated by males versus females. Hidalgo experiences the \ngreatest difference with females generating 86% more revenue than males.") +
theme_minimal() +
theme(axis.title = element_blank(),
panel.grid.major.x = element_blank(),
panel.grid.minor = element_blank(),
legend.title = element_blank(),
legend.justification = c(0, 1),
legend.position = c(.1, 1.05),
legend.background = element_blank(),
legend.direction="horizontal",
text = element_text(family = "Georgia"),
plot.title = element_text(size = 20, margin = margin(b = 10)),
plot.subtitle = element_text(size = 12, color = "darkslategrey", margin = margin(b = 25)),
plot.caption = element_text(size = 8, margin = margin(t = 10), color = "grey70", hjust = 0),
margin(r = 1))
p + scale_color_discrete(labels = c("Female", "Male")) +
scale_x_continuous(labels = scales::dollar, expand = c(0.02, 0),
limits = c(0, 10500),
breaks = seq(0, 10000, by = 2500)) +
scale_y_discrete(expand = c(.02, 0)) +
labs(title = "Total Revenue by City and Gender",
subtitle = "Out of 23 cities, eight locations experience a 20% or greater difference in \nrevenue generated by males versus females. Hidalgo experiences the \ngreatest difference with females generating 86% more revenue than males.") +
theme_minimal() +
theme(axis.title = element_blank(),
panel.grid.major.x = element_blank(),
panel.grid.minor = element_blank(),
legend.title = element_blank(),
legend.justification = c(0, 1),
legend.position = c(.1, 1.05),
legend.background = element_blank(),
legend.direction="horizontal",
text = element_text(family = "Georgia"),
plot.title = element_text(size = 20, margin = margin(b = 10)),
plot.subtitle = element_text(size = 12, color = "darkslategrey", margin = margin(b = 25)),
plot.caption = element_text(size = 8, margin = margin(t = 10), color = "grey70", hjust = 0))
setwd("~/Desktop/Personal/Visualization/Lollipop Chart")
data
data()
data(package = "tidyr")
data(package = "dplyr")
data(package = "ggplot2")
data(data = economics, package = "ggplot2")
economics
head(economics)
head(midwest)
data(data = midwest, package = "ggplot2")
head(midwest)
View(midwest)
?midwest
library(ggplot2)
library(dplyr)
midwest
?midwest
midwest %>%
filter(state == "OH") %>%
select(county, percollege) %>%
arrange(percollege)
midwest %>%
filter(state == "OH") %>%
select(county, percollege) %>%
arrange(percollege) %>%
mutate(county = factor(county, levels = .$county))
midwest %>%
filter(state == "OH") %>%
select(county, percollege) %>%
arrange(desc(percollege)) %>%
slice(5) %>%
arrange(percollege) %>%
mutate(county = factor(county, levels = .$county))
midwest %>%
filter(state == "OH") %>%
select(county, percollege) %>%
arrange(desc(percollege)) %>%
slice(5) %>%
arrange(percollege) %>%
mutate(county = factor(county, levels = .$county))
midwest %>%
filter(state == "OH") %>%
select(county, percollege) %>%
arrange(desc(percollege)) %>%
top_n(5) %>%
arrange(percollege) %>%
mutate(county = factor(county, levels = .$county))
icon <- midwest %>%
filter(state == "OH") %>%
select(county, percollege) %>%
arrange(desc(percollege)) %>%
top_n(5) %>%
arrange(percollege) %>%
mutate(county = factor(county, levels = .$county))
ggplot(icon, aes(percollege, county)) +
geom_segment(yend = percollege, xend = 0)
ggplot(icon, aes(percollege, county))
+
geom_segment(yend = x, xend = 0)
ggplot(icon, aes(percollege, county)) +
geom_segment(xend = percollege, yend = 0)
ggplot(icon, aes(percollege, county)) +
geom_segment(aes(xend = percollege, yend = 0))
ggplot(icon, aes(percollege, county)) +
geom_line()
ggplot(icon, aes(percollege, county)) +
geom_line(aes(group = 1))
ggplot(icon, aes(percollege, county)) +
geom_segment(aes(x = 0, y = county, xend = percollege, yend = county))
geom_segment
?geom_segment
ggplot(icon, aes(percollege, county)) +
geom_segment(aes(x = 0, y = county, xend = percollege, yend = county)) +
geom_point()
midwest %>%
filter(state == "OH") %>%
select(county, percollege) %>%
arrange(desc(percollege)) %>%
slice(c(1, 15, 30, 45, 60)) %>%
arrange(percollege)
icon <- midwest %>%
filter(state == "OH") %>%
select(county, percollege) %>%
arrange(desc(percollege)) %>%
slice(c(1, 15, 30, 45, 60)) %>%
arrange(percollege) %>%
mutate(county = factor(county, levels = .$county))
ggplot(icon, aes(percollege, county)) +
geom_segment(aes(x = 0, y = county, xend = percollege, yend = county)) +
geom_point()
icon <- midwest %>%
filter(state == "OH") %>%
select(county, percollege) %>%
arrange(desc(percollege)) %>%
slice(c(1, 15, 30, 45, 60)) %>%
arrange(percollege) %>%
mutate(county = factor(county, levels = .$county))
ggplot(icon, aes(percollege, county)) +
geom_segment(aes(x = 0, y = county, xend = percollege, yend = county)) +
geom_point(size = 3)
icon <- midwest %>%
filter(state == "OH") %>%
select(county, percollege) %>%
arrange(desc(percollege)) %>%
slice(c(1, 15, 30, 45, 60)) %>%
arrange(percollege) %>%
mutate(county = factor(county, levels = .$county))
ggplot(icon, aes(percollege, county)) +
geom_segment(aes(x = 0, y = county, xend = percollege, yend = county), color = "#fdfdfd") +
geom_point(size = 3)
icon <- midwest %>%
filter(state == "OH") %>%
select(county, percollege) %>%
arrange(desc(percollege)) %>%
slice(c(1, 15, 30, 45, 60)) %>%
arrange(percollege) %>%
mutate(county = factor(county, levels = .$county))
ggplot(icon, aes(percollege, county)) +
geom_segment(aes(x = 0, y = county, xend = percollege, yend = county), color = "grey50") +
geom_point(size = 3)
ggplot(icon, aes(percollege, county)) +
geom_segment(aes(x = 0, y = county, xend = percollege, yend = county), color = "grey50") +
geom_point(size = 3) +
scale_y_discrete(labels = rev(LETTERS[1:5]))
ggplot(icon, aes(percollege, county)) +
geom_segment(aes(x = 0, y = county, xend = percollege, yend = county), color = "grey50") +
geom_point(size = 3) +
scale_y_discrete(labels = rev(LETTERS[1:5])) +
scale_x_continuous(labels = scales::percent) +
theme_minimal()
ggplot(icon, aes(percollege/100, county)) +
geom_segment(aes(x = 0, y = county, xend = percollege, yend = county), color = "grey50") +
geom_point(size = 3) +
scale_y_discrete(labels = rev(LETTERS[1:5])) +
scale_x_continuous(labels = scales::percent) +
theme_minimal()
icon <- midwest %>%
filter(state == "OH") %>%
select(county, percollege) %>%
arrange(desc(percollege)) %>%
slice(c(1, 15, 30, 45, 60)) %>%
arrange(percollege) %>%
mutate(county = factor(county, levels = .$county),
percollege = percollege / 100)
ggplot(icon, aes(percollege, county)) +
geom_segment(aes(x = 0, y = county, xend = percollege, yend = county), color = "grey50") +
geom_point(size = 3) +
scale_y_discrete(labels = rev(LETTERS[1:5])) +
scale_x_continuous(labels = scales::percent) +
theme_minimal()
ggplot(icon, aes(percollege, county)) +
geom_segment(aes(x = 0, y = county, xend = percollege, yend = county), color = "grey50") +
geom_point(size = 3) +
scale_y_discrete(labels = rev(LETTERS[1:5])) +
scale_x_continuous(labels = scales::percent) +
theme_minimal() +
theme(plot.background = element_rect(fill = "#fdfdfd", color = "#fdfdfd", size = .2),
axis.ticks = element_blank(),
axis.title = element_blank(),
panel.grid.major.y = element_line(color = "grey50", linetype = "dotted"),
panel.grid.major.x = element_blank(),
panel.grid.minor = element_blank(),
legend.position = "none")
ggplot(icon, aes(percollege, county)) +
geom_segment(aes(x = 0, y = county, xend = percollege, yend = county), color = "grey50") +
geom_point(size = 3) +
scale_y_discrete(labels = rev(LETTERS[1:5])) +
scale_x_continuous(labels = scales::percent) +
theme_minimal() +
theme(plot.background = element_rect(fill = "#fdfdfd", color = "#fdfdfd", size = .2),
axis.ticks = element_blank(),
axis.title = element_blank(),
panel.grid.major.x = element_line(color = "grey50", linetype = "dotted"),
panel.grid.major.y = element_blank(),
panel.grid.minor = element_blank(),
legend.position = "none")
ggplot(icon, aes(percollege, county)) +
geom_segment(aes(x = 0, y = county, xend = percollege, yend = county), color = "grey50") +
geom_point(size = 3) +
scale_y_discrete(labels = rev(LETTERS[1:5])) +
scale_x_continuous(labels = scales::percent, expand = c(0, 0)) +
theme_minimal() +
theme(plot.background = element_rect(fill = "#fdfdfd", color = "#fdfdfd", size = .2),
axis.ticks = element_blank(),
axis.title = element_blank(),
panel.grid.major.x = element_line(color = "grey50", linetype = "dotted"),
panel.grid.major.y = element_blank(),
panel.grid.minor = element_blank(),
legend.position = "none")
ggplot(icon, aes(percollege, county)) +
geom_segment(aes(x = 0, y = county, xend = percollege, yend = county), color = "grey50") +
geom_point(size = 3) +
scale_y_discrete(labels = rev(LETTERS[1:5])) +
scale_x_continuous(limits = c(0, .35), labels = scales::percent, expand = c(0, 0)) +
theme_minimal() +
theme(plot.background = element_rect(fill = "#fdfdfd", color = "#fdfdfd", size = .2),
axis.ticks = element_blank(),
axis.title = element_blank(),
panel.grid.major.x = element_line(color = "grey50", linetype = "dotted"),
panel.grid.major.y = element_blank(),
panel.grid.minor = element_blank(),
legend.position = "none")
?midwest
midwest %>%
filter(state == "OH") %>%
select(county, percollege) %>%
arrange(desc(percollege))
?midwest
midwest
str(midwest)
unique(midwest$state)
midwest %>%
filter(state == "OH") %>%
select(county, percollege) %>%
arrange(desc(percollege)) %>%
top_n(25) %>%
arrange(percollege) %>%
mutate(county = factor(county, levels = .$county))
ohio_top25 <- midwest %>%
filter(state == "OH") %>%
select(county, percollege) %>%
arrange(desc(percollege)) %>%
top_n(25) %>%
arrange(percollege) %>%
mutate(county = factor(county, levels = .$county))
ggplot(ohio_top25, aes(county, percollege)) +
geom_bar(stat = "identity") +
coord_flip()
ggplot(ohio_top25, aes(percollege, counties)) +
geom_point()
ggplot(ohio_top25, aes(percollege, county)) +
geom_point()
ggplot(ohio_top25, aes(percollege, county)) +
geom_segment(aes(x = 0, y = county, xend = percollege, yend = county), color = "grey50")
ggplot(ohio_top25, aes(percollege, county)) +
geom_segment(aes(x = 0, y = county, xend = percollege, yend = county), color = "grey50") +
geom_point()
# bar chart
p1 <- ggplot(ohio_top25, aes(county, percollege)) +
geom_bar(stat = "identity") +
coord_flip()
# dot plot
p2 <- ggplot(ohio_top25, aes(percollege, county)) +
geom_point()
# lollipop chart
p3 <- ggplot(ohio_top25, aes(percollege, county)) +
geom_segment(aes(x = 0, y = county, xend = percollege, yend = county), color = "grey50") +
geom_point()
grid.arrange(p1, p2, p3, ncol = 3)
library(gridExtra)
ohio_top25 <- midwest %>%
filter(state == "OH") %>%
select(county, percollege) %>%
arrange(desc(percollege)) %>%
top_n(25) %>%
arrange(percollege) %>%
mutate(county = factor(county, levels = .$county))
# bar chart
p1 <- ggplot(ohio_top25, aes(county, percollege)) +
geom_bar(stat = "identity") +
coord_flip()
# dot plot
p2 <- ggplot(ohio_top25, aes(percollege, county)) +
geom_point()
# lollipop chart
p3 <- ggplot(ohio_top25, aes(percollege, county)) +
geom_segment(aes(x = 0, y = county, xend = percollege, yend = county), color = "grey50") +
geom_point()
grid.arrange(p1, p2, p3, ncol = 3)
# bar chart
ggplot(ohio_top25, aes(county, percollege)) +
geom_bar(stat = "identity") +
coord_flip()
# dot plot
ggplot(ohio_top25, aes(percollege, county)) +
geom_point()
# lollipop chart
ggplot(ohio_top25, aes(percollege, county)) +
geom_segment(aes(x = 0, y = county, xend = percollege, yend = county), color = "grey50") +
geom_point()
unique(midwest$state)
midwest %>%
filter(state == "OH" | state == "MI" | state == "IN") %>%
select(county, percollege) %>%
group_by(state) %>%
arrange(desc(percollege)) %>%
top_n(25)
midwest %>%
filter(state == "OH" | state == "MI" | state == "IN") %>%
select(state, county, percollege) %>%
group_by(state) %>%
arrange(desc(percollege)) %>%
top_n(25)
top25 <- midwest %>%
filter(state == "OH" | state == "MI" | state == "IN") %>%
select(state, county, percollege) %>%
group_by(state) %>%
arrange(desc(percollege)) %>%
top_n(25) %>%
arrange(percollege) %>%
mutate(county = factor(county, levels = .$county))
midwest %>%
filter(state == "OH" | state == "MI" | state == "IN") %>%
select(state, county, percollege) %>%
group_by(state) %>%
arrange(desc(percollege)) %>%
top_n(25) %>%
arrange(percollege)
midwest %>%
filter(state == "OH" | state == "MI" | state == "IN") %>%
select(state, county, percollege) %>%
group_by(state) %>%
arrange(desc(percollege)) %>%
top_n(25) %>%
arrange(percollege) %>%
mutate(county = factor(county, levels = .$county))
midwest %>%
filter(state == "OH" | state == "MI" | state == "IN") %>%
select(state, county, percollege) %>%
group_by(state) %>%
arrange(desc(percollege)) %>%
top_n(25) %>%
arrange(percollege)
midwest %>%
filter(state == "OH" | state == "MI" | state == "IN") %>%
select(state, county, percollege) %>%
group_by(state) %>%
arrange(desc(percollege)) %>%
top_n(25) %>%
ungroup() %>%
arrange(percollege) %>%
mutate(county = factor(county, levels = .$county))
top25 <- midwest %>%
filter(state == "OH" | state == "MI" | state == "IN") %>%
select(state, county, percollege) %>%
group_by(state) %>%
arrange(desc(percollege)) %>%
top_n(25) %>%
ungroup() %>%
arrange(percollege) %>%
mutate(county = factor(county, levels = .$county))
ggplot(top25, aes(percollege, county, color = state)) +
geom_segment(aes(x = 0, y = county, xend = percollege, yend = county), color = "grey50") +
geom_point()
View(top25)
ggplot(top25, aes(percollege, county, color = state)) +
geom_segment(aes(x = 0, y = county, xend = percollege, yend = county), color = "grey50") +
geom_point() +
facet_wrap(~ state)
ggplot(top25, aes(percollege, county)) +
geom_segment(aes(x = 0, y = county, xend = percollege, yend = county), color = "grey50") +
geom_point() +
facet_wrap(. ~ state)
ggplot(top25, aes(percollege, county)) +
geom_segment(aes(x = 0, y = county, xend = percollege, yend = county), color = "grey50") +
geom_point() +
facet_wrap(~ state)
ggplot(top25, aes(percollege, county)) +
geom_segment(aes(x = 0, y = county, xend = percollege, yend = county), color = "grey50") +
geom_point() +
facet_wrap(~ state, scales = "free_y")
ggplot(top25, aes(percollege, county)) +
geom_segment(aes(x = 0, y = county, xend = percollege, yend = county), color = "grey50") +
geom_point()
ggplot(top25, aes(percollege, county)) +
geom_segment(aes(x = 0, y = county, xend = percollege, yend = county), color = "grey50") +
geom_point() +
facet_wrap(~ state, scales = "free_y")
top25 <- midwest %>%
filter(state == "OH" | state == "MI" | state == "IN") %>%
select(state, county, percollege) %>%
group_by(state) %>%
arrange(desc(percollege)) %>%
top_n(25) %>%
ungroup() %>%
arrange(percollege) %>%
mutate(county = factor(county, levels = .$county))
ggplot(top25, aes(percollege, county, color = state)) +
geom_segment(aes(x = 0, y = county, xend = percollege, yend = county), color = "grey50") +
geom_point()
str(top25)
midwest %>%
filter(state == "OH" | state == "MI" | state == "IN") %>%
select(state, county, percollege) %>%
group_by(state) %>%
arrange(desc(percollege)) %>%
top_n(25)
top10 <- midwest %>%
filter(state == "OH" | state == "MI" | state == "IN") %>%
select(state, county, percollege) %>%
group_by(state) %>%
arrange(desc(percollege)) %>%
top_n(10) %>%
ungroup() %>%
arrange(percollege) %>%
mutate(county = factor(county, levels = .$county))
ggplot(top10, aes(percollege, county, color = state)) +
geom_segment(aes(x = 0, y = county, xend = percollege, yend = county), color = "grey50") +
geom_point()
top10 <- midwest %>%
filter(state == "OH" | state == "MI" | state == "IN") %>%
select(state, county, percollege) %>%
group_by(state) %>%
arrange(desc(percollege)) %>%
top_n(5) %>%
ungroup() %>%
arrange(percollege) %>%
mutate(county = factor(county, levels = .$county))
ggplot(top10, aes(percollege, county, color = state)) +
geom_segment(aes(x = 0, y = county, xend = percollege, yend = county), color = "grey50") +
geom_point()
top10 <- midwest %>%
filter(state == "OH" | state == "MI" | state == "IN") %>%
select(state, county, percollege) %>%
group_by(state) %>%
arrange(desc(percollege)) %>%
top_n(10) %>%
ungroup() %>%
arrange(percollege) %>%
mutate(county = factor(county, levels = .$county))
ggplot(top10, aes(percollege, county, color = state)) +
geom_segment(aes(x = 0, y = county, xend = percollege, yend = county), color = "grey50") +
geom_point()
midwest %>%
filter(state == "OH") %>%
mutate(Avg = mean(percollege, na.rm = TRUE))
midwest %>%
filter(state == "OH") %>%
select(county, percollege) %>%
mutate(Avg = mean(percollege, na.rm = TRUE))
midwest %>%
filter(state == "OH") %>%
select(county, percollege) %>%
arrange(percollege) %>%
mutate(Avg = mean(percollege, na.rm = TRUE))
midwest %>%
filter(state == "OH") %>%
select(county, percollege) %>%
arrange(percollege) %>%
mutate(Avg = mean(percollege, na.rm = TRUE),
Above = ifelse(percollege - Avg > 0, TRUE, FALSE))
ohio <- midwest %>%
filter(state == "OH") %>%
select(county, percollege) %>%
arrange(percollege) %>%
mutate(Avg = mean(percollege, na.rm = TRUE),
Above = ifelse(percollege - Avg > 0, TRUE, FALSE),
county = factor(county, levels = .$county))
ggplot(ohio, aes(percollege, county, color = Above)) +
geom_segment(aes(x = Avg, y = county, xend = percollege, yend = county), color = "grey50") +
geom_point()
ohio <- midwest %>%
filter(state == "OH") %>%
select(county, percollege) %>%
arrange(percollege) %>%
mutate(Avg = mean(percollege, na.rm = TRUE),
Above = ifelse(percollege - Avg > 0, TRUE, FALSE),
county = factor(county, levels = .$county))
ggplot(ohio, aes(percollege, county, color = Above)) +
geom_segment(aes(x = Avg, y = county, xend = percollege, yend = county), color = "grey50") +
geom_point()
